# Hexo 博客更新指南

## 📚 目录

- [基本概念](#基本概念)
- [日常更新流程](#日常更新流程)
- [常用命令速查](#常用命令速查)
- [文件结构说明](#文件结构说明)
- [常见问题](#常见问题)
- [注意事项](#注意事项)

## 基本概念

### 双分支工作流

您的博客使用双分支工作流来管理：

- **hexo 分支**：存放 Hexo 源文件
  - Markdown 文章（`source/_posts/`）
  - 配置文件（`_config.yml`）
  - 主题文件
  - 这是您需要编辑的分支

- **master 分支**：存放生成的静态 HTML 文件
  - 由 Hexo 自动生成
  - GitHub Pages 直接从这个分支读取内容
  - **不要手动编辑这个分支的文件**

### 工作流程

```
编辑源文件 (hexo 分支) 
  ↓
本地预览测试
  ↓
生成静态文件 (hexo generate)
  ↓
提交源文件到 hexo 分支 (git push origin hexo)
  ↓
部署到 master 分支 (hexo deploy)
  ↓
GitHub Pages 自动更新
```

## 日常更新流程

### 方法一：完整流程（推荐）

#### 步骤 1：进入博客目录

```bash
cd blog
```

#### 步骤 2：创建新文章

```bash
hexo new "文章标题"
```

这会在 `blog/source/_posts/` 目录下创建一个新的 Markdown 文件，文件名格式为：`文章标题.md`

#### 步骤 3：编辑文章

使用任何文本编辑器打开并编辑刚创建的文件。

**文章格式示例**：

```markdown
---
title: 文章标题
date: 2024-01-01 12:00:00
tags: 
  - 标签1
  - 标签2
categories: 分类名称
top: 10  # 置顶（可选，数字越大越靠前）
---

<!--more-->  <!-- 这是摘要分隔符，上面的内容会显示在首页 -->

这里是文章的正文内容...

## 二级标题

正文内容...

### 三级标题

更多内容...
```

**Front-matter 常用字段说明**：

- `title`: 文章标题（必需）
- `date`: 发布日期（必需，格式：YYYY-MM-DD HH:mm:ss）
- `tags`: 标签（可选，可以是字符串或列表）
- `categories`: 分类（可选）
- `top`: 置顶（可选，数字越大越靠前）
- `description`: 文章描述（可选，用于 SEO）

#### 步骤 4：本地预览（强烈推荐）

在部署前，先本地预览检查效果：

```bash
hexo server
# 或简写
hexo s
```

然后在浏览器访问 `http://localhost:4000` 查看效果。

**提示**：
- 预览时修改文章内容，浏览器会自动刷新
- 按 `Ctrl + C` 停止预览服务器

#### 步骤 5：生成静态文件

```bash
hexo clean    # 清理旧的生成文件（推荐先执行）
hexo generate # 生成静态文件
# 或简写
hexo g
```

#### 步骤 6：提交源文件到 hexo 分支

**重要**：先提交源文件，再部署！

```bash
# 确保在项目根目录（不是 blog 目录）
cd ..  # 如果当前在 blog 目录，先返回上一级

# 检查当前分支（应该是 hexo）
git branch

# 添加所有更改
git add .

# 提交更改
git commit -m "添加新文章：文章标题"

# 推送到 hexo 分支
git push origin hexo
```

#### 步骤 7：部署到 GitHub Pages

```bash
cd blog
hexo deploy
# 或简写
hexo d
```

这会自动将生成的静态文件推送到 master 分支，GitHub Pages 会自动更新。

### 方法二：快速更新（已确认无误的文章）

如果文章已经测试无误，可以一键完成：

```bash
cd blog
hexo clean && hexo g && hexo d
```

然后记得提交源文件：

```bash
cd ..
git add .
git commit -m "更新文章"
git push origin hexo
```

## 常用命令速查

### 文章管理

```bash
# 创建新文章
hexo new "文章标题"

# 创建草稿（不会发布）
hexo new draft "草稿标题"

# 发布草稿（将草稿转为正式文章）
hexo publish "草稿标题"
```

### 本地开发

```bash
# 启动本地服务器（默认端口 4000）
hexo server
# 或
hexo s

# 指定端口启动
hexo server -p 5000

# 启动服务器并自动打开浏览器
hexo server -o
```

### 生成和部署

```bash
# 清理缓存和生成的文件
hexo clean

# 生成静态文件
hexo generate
# 或
hexo g

# 部署到 GitHub
hexo deploy
# 或
hexo d

# 一键生成并部署
hexo clean && hexo g && hexo d
```

### Git 操作

```bash
# 查看当前分支
git branch

# 切换到 hexo 分支（如果不在）
git checkout hexo

# 查看文件状态
git status

# 添加所有更改
git add .

# 提交更改
git commit -m "提交说明"

# 推送到远程 hexo 分支
git push origin hexo

# 查看提交历史
git log
```

## 文件结构说明

```
dadongshangu.github.io/
├── blog/                    # Hexo 博客主目录
│   ├── _config.yml          # Hexo 主配置文件 ⚙️
│   ├── package.json         # 依赖包配置
│   ├── source/              # 源文件目录
│   │   ├── _posts/          # 博客文章目录 📝
│   │   │   ├── 文章1.md
│   │   │   └── 文章2.md
│   │   ├── about/           # 关于页面
│   │   │   └── index.md
│   │   ├── categories/      # 分类页面
│   │   ├── tags/            # 标签页面
│   │   └── ...
│   ├── themes/              # 主题目录
│   │   └── next/            # Next 主题
│   │       └── _config.yml  # 主题配置文件 ⚙️
│   └── public/              # 生成的静态文件（自动生成，不要手动编辑）
├── index.html               # 根目录首页
└── 更新指南.md              # 本文件
```

**重要文件说明**：

- `blog/_config.yml`：Hexo 主配置文件，包含站点信息、URL、部署配置等
- `blog/themes/next/_config.yml`：Next 主题配置文件，控制主题外观和功能
- `blog/source/_posts/`：存放所有博客文章的目录
- `blog/public/`：生成的静态文件，**不要手动编辑**

## 常见问题

### 1. 如何修改文章？

直接编辑 `blog/source/_posts/` 目录下对应的 Markdown 文件，然后：

```bash
cd blog
hexo clean && hexo g && hexo d
cd ..
git add .
git commit -m "修改文章：文章标题"
git push origin hexo
```

### 2. 如何删除文章？

删除 `blog/source/_posts/` 目录下对应的 Markdown 文件，然后重新生成和部署：

```bash
cd blog
hexo clean && hexo g && hexo d
cd ..
git add .
git commit -m "删除文章：文章标题"
git push origin hexo
```

### 3. 如何修改站点配置？

编辑 `blog/_config.yml` 文件，修改后需要重新生成和部署。

### 4. 如何修改主题配置？

编辑 `blog/themes/next/_config.yml` 文件，修改后需要重新生成和部署。

### 5. 本地预览正常，但部署后有问题？

1. 检查 `blog/_config.yml` 中的 `url` 配置是否正确
2. 执行 `hexo clean` 清理缓存
3. 重新生成和部署

### 6. 如何添加图片？

**方法一：使用外部链接（推荐）**

```markdown
![图片描述](https://cdn.jsdelivr.net/gh/用户名/仓库名@master/images/图片名.jpg)
```

**方法二：使用本地图片**

1. 在 `blog/source/images/` 目录下放置图片
2. 在文章中使用：

```markdown
![图片描述](/images/图片名.jpg)
```

### 7. 如何设置文章摘要？

在文章中使用 `<!--more-->` 标签，上面的内容会显示在首页作为摘要。

### 8. 如何置顶文章？

在文章的 front-matter 中添加 `top` 字段：

```yaml
---
title: 文章标题
date: 2024-01-01 12:00:00
top: 10  # 数字越大越靠前
---
```

### 9. 部署失败怎么办？

1. 检查网络连接
2. 检查 Git 配置是否正确
3. 检查 `blog/_config.yml` 中的 deploy 配置
4. 尝试手动推送：

```bash
cd blog/public
git init
git add .
git commit -m "手动部署"
git remote add origin git@github.com:dadongshangu/dadongshangu.github.io.git
git push -f origin master
```

### 10. 如何更新 Hexo 和主题？

```bash
cd blog

# 更新 Hexo
npm update hexo

# 更新 Next 主题（如果使用 Git 子模块）
cd themes/next
git pull
cd ../..

# 更新所有依赖
npm update
```

## 注意事项

### ⚠️ 重要提醒

1. **始终在 hexo 分支工作**
   - 编辑源文件时确保在 hexo 分支
   - 使用 `git branch` 检查当前分支

2. **先提交源文件，再部署**
   - 顺序：`git push origin hexo` → `hexo deploy`
   - 这样可以确保源文件已备份

3. **不要手动编辑 public 目录**
   - `public/` 目录是自动生成的
   - 所有修改都会在下次生成时被覆盖

4. **定期提交更改**
   - hexo 分支就是您的备份
   - 每次修改后及时提交，避免丢失工作

5. **本地预览很重要**
   - 部署前务必本地预览
   - 可以避免部署后发现错误

6. **URL 配置要正确**
   - `blog/_config.yml` 中的 `url` 必须是正确的 GitHub Pages 地址
   - 当前配置：`https://dadongshangu.github.io`

### 📝 最佳实践

1. **文章命名**：使用有意义的文件名，避免特殊字符
2. **定期备份**：定期推送到 hexo 分支
3. **测试更改**：修改配置后先本地预览
4. **版本控制**：重要修改前先提交当前版本
5. **保持更新**：定期更新 Hexo 和主题（可选）

## 快速参考卡片

### 创建并发布新文章

```bash
# 1. 创建文章
cd blog
hexo new "文章标题"

# 2. 编辑文章（使用文本编辑器）

# 3. 预览
hexo server

# 4. 生成并部署
hexo clean && hexo g && hexo d

# 5. 提交源文件
cd ..
git add .
git commit -m "添加新文章：文章标题"
git push origin hexo
```

### 修改现有文章

```bash
# 1. 编辑文章（使用文本编辑器）

# 2. 预览
cd blog
hexo server

# 3. 生成并部署
hexo clean && hexo g && hexo d

# 4. 提交源文件
cd ..
git add .
git commit -m "修改文章：文章标题"
git push origin hexo
```

---

**需要帮助？**

- Hexo 官方文档：https://hexo.io/zh-cn/docs/
- Next 主题文档：https://theme-next.org/
- GitHub 仓库：https://github.com/dadongshangu/dadongshangu.github.io

祝您写作愉快！📝✨
